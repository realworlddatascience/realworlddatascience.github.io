---
title: "Pulling patterns out of data with a graph"
description: |
  Large volumes of data are pouring in every day from scientific experiments, so much so that it is now commonplace to perform dimension reduction in order to reduce a large number of measurements to a set of key values that are easier to visualize and interpret. Enter 'The Sequencer', a proposed method to find trends within high-dimensional datasets.  
categories:
  - Data management
  - Dimension reduction
  - Graph theory
author: Andrew Saydjari
date: 01/24/2023
image: images/signal-from-noise.png
image-alt: A researcher in a field shines a light on stylised waves of noise, as if attempting to identify or extract a signal. Image generated by DALL.E 2 from prompts provided by Real World Data Science.
toc: true
aliases: 
  - /news-and-views/datasciencebites/posts/2023/01/24/pulling-patterns.html
  - /ideas/datasciencebites/posts/2023/01/24/pulling-patterns.html
---
:::{.callout-note style="margin-top: 0rem;" collapse="false"}
## About the paper and this post

**Title:** Extracting the main trend in a data set: The Sequencer algorithm

**Author(s) and year:** Dalya Baron and Brice Ménard (2021)

**Status:** Published in *The Astrophysical Journal*, open access: [HTML](https://iopscience.iop.org/article/10.3847/1538-4357/abfc4d), [PDF](https://iopscience.iop.org/article/10.3847/1538-4357/abfc4d/pdf). 

**Editor's note:** This post is republished with permission from [MathStatBites](https://mathstatbites.org/pulling-patterns-out-of-data-with-a-graph/) to demonstrate the Bites concept. For more information about Bites articles and how to contribute to DataScienceBites, see our [notes for contributors](/contributor-docs/datasciencebites.qmd){aria-label="Contributor notes for the Data Science Bites blog"}.
:::

Large volumes of data are pouring in every day from scientific experiments like [CERN](https://home.cern/) and the [Sloan Digital Sky Survey](https://www.sdss5.org/). Data is coming in so fast that researchers struggle to keep pace with the analysis and are increasingly developing automated analysis methods to aid in this herculean task. As a first step, it is now commonplace to perform dimension reduction in order to reduce a large number of measurements to a set of key values that are easier to visualize and interpret.

When working on the cutting edge, another problem scientists often face is that "we don’t know what we don’t know". For this reason, we often want to simply ask the data, "What is interesting about you?" This is the realm of ["unsupervised" methods](https://en.wikipedia.org/wiki/Unsupervised_learning), where the data itself drives the analysis, with little to no guidance or human labeling of the data. 

Many physical processes depend continuously on some driving parameter. For example, the evaporation rate of water increases with temperature. We call these continuous variations in datasets "trends". Describing a dataset by a single trend reduces it to one dimension - an ordered list. Finding such a trend within a high-dimensional dataset is the aim of a method called "The Sequencer" introduced by Baron and Ménard.

## Key insight: A tree
The key insight of Baron and Ménard was to relate trends in data to an object from graph theory called a [minimum spanning tree](https://en.wikipedia.org/wiki/Minimum_spanning_tree). Given a measure of distance between two data points, for example the usual (Euclidean) distance between two points, we can visualize a dataset as a graph. This graph consists of a node (a dot) for each data point. These nodes are then connected by an edge (a line), labeled by the distance between the two data points. The minimum spanning tree is a reduction of this graph to include only enough of the smallest distance edges so that no node is isolated.

What Baron and Ménard realized is that datasets that are "trendy" have elongated and narrow minimum spanning trees. As shown in Figure 1, a totally random dataset results in a graph with many branches while a perfect sequence results in a perfect linear graph. Then, they use connectivity of the nodes in the minimum spanning tree to return an ordering of the data that follows the main trend in the dataset. However, a sequence is all you get. It is up to us to understand and interpret what this trend represents.

::: {.column-page}
![](images/fig1.png){fig-alt="Three examples - labelled 'random data', 'noisy sequence', and 'perfect sequence' - demonstrating that data with stronger trends ('noisy' and 'perfect sequence') have more narrow and elongated minimum spanning trees (adapted from Baron and Ménard, Figure 1)."}
:::
::: {.column-margin}
**Figure 1:** Examples demonstrating that data with stronger trends have more narrow and elongated minimum spanning trees. Adapted from [Baron and Ménard (2021)](https://iopscience.iop.org/article/10.3847/1538-4357/abfc4d){aria-label="Link to Baron and Ménard's 2021 paper, 'Extracting the main trend in a data set: The Sequencer algorithm'"}, Figure 1. Figure used under [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/){aria-label="Link to Creative Commons licence"}.
:::

Sometimes, the ordering of observations within a data point matters, like in time series data. Measurements taken close in time are more likely to be correlated than measurements taken after a long time delay. Baron and Ménard were careful to include a measure of distance that takes this ordering into account, unlike our usual notion of distance. They argue that this gives them an edge over other common dimension reduction techniques such as [t-SNE](https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding) and [UMAP](https://umap-learn.readthedocs.io/en/latest/how_umap_works.html), and even go so far as to use The Sequencer to optimize the hyperparameters used by these other methods!

## When does it fail?
It is important to acknowledge that no statistical or machine-learning tool is a cure-all. And, the authors themselves are quick to point out several limitations that can hinder the application of their method. The Sequencer can struggle when the data has a large dynamic range, a variety of signal strengths relative to noise, or there are multiple trends present in the data. In each case, Baron and Ménard propose ways to mitigate these problems, but practitioners still need to be wary when applying The Sequencer in those instances.

## What discoveries await?
To demonstrate the power of their method, Baron and Ménard apply The Sequencer to several real datasets where a pattern was already known and show that The Sequencer recovers that pattern. Examples include ordering spectral measurements of stars by their temperature and [quasars](https://en.wikipedia.org/wiki/Quasar) by their [redshift](https://en.wikipedia.org/wiki/Redshift_survey), a measure of their distance from us on Earth.

But, what about new patterns? The team has already applied The Sequencer to mine seismographic data and discover previously unknown formations deep within the earth, at the boundary between the core and [mantle](https://en.wikipedia.org/wiki/Core%E2%80%93mantle_boundary). By sequencing the seismic waves, they realized that the main trend was the amplitude of diffraction off of these structures, which they were then able to localize beneath Hawaii and the Marquesas (DOI: [10.1126/science.aba8972](https://doi.org/10.1126/science.aba8972){aria-label="Link to article, 'Sequencing seismograms: A panoptic view of scattering in the core-mantle boundary region'"}).

For more demonstrations and discoveries, or even to upload your own data for sequencing, [check out the project website](http://sequencer.org/). Data sleuths can also download all of the code directly from [GitHub](https://github.com/dalya/Sequencer) and sequence to their hearts’ content!
\
\

::: {.further-info}
::: grid
::: {.g-col-12 .g-col-md-6}
About the author
: **Andrew Saydjari**  is a graduate student in physics at Harvard researching the spatial and chemical variations of dust in the interstellar medium. He favors using interpretable statistics and large photometric and spectroscopic surveys.
:::

::: {.g-col-12 .g-col-md-6}
About DataScienceBites
: [**DataScienceBites**](/foundation-frontiers/datasciencebites/index.qmd) is written by graduate students and early career researchers in data science (and related subjects) at universities throughout the world, as well as industry researchers. We publish digestible, engaging summaries of interesting new pre-print and peer-reviewed publications in the data science space, with the goal of making scientific papers more accessible. Find out how to [become a contributor](/contributor-docs/datasciencebites.qmd).
:::
:::
:::